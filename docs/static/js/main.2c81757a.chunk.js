(this["webpackJsonpspace-sim"]=this["webpackJsonpspace-sim"]||[]).push([[0],{134:function(e){e.exports=JSON.parse('[{"url":"localhost:3979","secure":false},{"url":"derpy.live:3979","secure":false},{"url":"ss.flynna.uk","secure":true},{"url":"sss2.flynna.uk","secure":true}]')},138:function(e,t,n){e.exports=n(353)},143:function(e,t,n){},145:function(e,t,n){},146:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg=="},168:function(e,t){},173:function(e,t,n){},174:function(e,t,n){},175:function(e,t,n){},342:function(e,t,n){},347:function(e,t,n){},348:function(e,t,n){},350:function(e,t,n){},351:function(e,t,n){},353:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(6),c=n.n(l),o=(n(143),n(75)),i=n.n(o),s=n(135),u=n(12),d=n(4),m=n(5),h=n(8),p=n(7),f=n(124),y=(n(145),n(146),n(125)),v=n.n(y),E=(n(173),n(47)),g=n(126),b=n.n(g),k={intervals:{},socket:null,server:null,root:document.getElementById("root"),fuel:{current:1,max:1,currentUsage:1}},w={mode:"dynamic",catchDistance:150,color:"white"},M={position:"relative",height:"4000px",width:"100%",background:"rgba(0, 0, 0, 0)"},I=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).managerListener=e.managerListener.bind(Object(E.a)(e)),e}return Object(m.a)(n,[{key:"managerListener",value:function(e){var t;e.on("start",(function(){t=Number(k.throttleSlider.value),k.socket.emit("accelerate",!0)})),e.on("end",(function(){k.socket.emit("throttle",t),k.socket.emit("accelerate",!1)})),e.on("move",(function(e,n){k.socket.emit("throttle",t*(n.distance/50)),k.socket.emit("setangle",360-n.angle.degree)}))}},{key:"render",value:function(){this.props.classes;return r.a.createElement("div",{id:"joystickControls",style:{display:"none"}},r.a.createElement(b.a,{joyOptions:w,containerStyle:M,managerListener:this.managerListener}))}}]),n}(r.a.Component),x=(n(174),{open:"+Chat",close:"-Chat"});function B(){return"block"==document.getElementById("chatBox").style.display}function A(){var e=B();document.getElementById("chatBox").style.display=e?"none":"block",document.getElementById("openChatButtonText").innerHTML=x[e?"open":"close"],document.getElementById("openChatButton").style.background=""}var S=function(){var e=document.getElementById("chatInput");""!=e.value&&(k.socket.emit("sendMessage",e.value),e.value="")},j=n(33),O=n(364);n(175);function L(e){document.getElementById("throttleLevel").innerHTML=e.toFixed(2),k.socket.emit("throttle",e)}var T,C=function(){var e=r.a.useState(.2),t=Object(j.a)(e,2),n=t[0],a=t[1];k.throttleSlider={value:n,setValue:a},r.a.useEffect((function(){return l(null,n)}));var l=function(e,t){a(t),L(t)};return r.a.createElement("div",{id:"throttleDiv"},r.a.createElement(O.a,{min:0,max:1,step:.01,value:n,onChange:l,valueLabelDisplay:"auto",valueLabelFormat:function(e){return"Fuel usage: ".concat((100*k.fuel.currentUsage).toFixed(1))}}),r.a.createElement("span",{id:"throttleLevel"},"0.25"))},P={ArrowRight:0,ArrowDown:90,ArrowLeft:180,ArrowUp:270,KeyD:0,KeyS:90,KeyA:180,KeyW:270,Numpad6:0,Numpad3:45,Numpad2:90,Numpad1:135,Numpad4:180,Numpad7:225,Numpad8:270,Numpad9:315},D=[];function N(e){var t,n=0,a=Object(u.a)(e);try{for(a.s();!(t=a.n()).done;){n+=t.value}}catch(r){a.e(r)}finally{a.f()}return n}function R(e){return Math.PI/180*e}function F(){if(D.length>0){var e,t=[],n=Object(u.a)(D);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(P[a])}}catch(l){n.e(l)}finally{n.f()}for(var r=180/Math.PI*Math.atan2(N(t.map(R).map(Math.sin))/t.length,N(t.map(R).map(Math.cos))/t.length);r<360;)r+=360;k.socket.emit("setangle",r)}}function W(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=Math.round(100*(Number(k.throttleSlider.value)+Number(.01)*(2*Number(e)-1)))/100;console.log(k),t>=0&&t<=1&&(k.throttleSlider.setValue(t),L(t))}function J(e){if("chatInput"!=document.activeElement.id){switch(e.code){case"Minus":case"ControlLeft":case"ControlRight":W(!1);break;case"Equal":case"ShiftLeft":case"ShiftRight":W(!0);break;case"KeyJ":k.socket.emit("hyperjump");break;case"Space":k.socket.emit("nuke")}switch(Number(T.value)){case 0:switch(e.code){case"KeyW":case"ArrowUp":k.socket.emit("accelerate",!0);break;case"KeyS":case"ArrowDown":k.socket.emit("decelerate",!0);break;case"KeyA":case"ArrowLeft":k.socket.emit("rotateleft",!0);break;case"KeyD":case"ArrowRight":k.socket.emit("rotateright",!0)}break;case 1:P.hasOwnProperty(e.code)&&(-1==D.indexOf(e.code)&&D.push(e.code),F(),1==D.length&&k.socket.emit("accelerate",!0))}}}function Z(e){switch(e.code){case"KeyT":B()||A(),"chatInput"!=document.activeElement.id&&document.getElementById("chatInput").focus();break;case"Enter":"chatInput"==document.activeElement.id&&S();break;case"Escape":"chatInput"==document.activeElement.id&&B()?A():"block"==document.getElementById("pauseMenu").style.display?ee():$()}switch(Number(T.value)){case 0:switch(e.code){case"KeyW":case"ArrowUp":k.socket.emit("accelerate",!1);break;case"KeyS":case"ArrowDown":k.socket.emit("decelerate",!1);break;case"KeyA":case"ArrowLeft":k.socket.emit("rotateleft",!1);break;case"KeyD":case"ArrowRight":k.socket.emit("rotateright",!1)}break;case 1:P.hasOwnProperty(e.code)&&(-1!=D.indexOf(e.code)&&D.splice(D.indexOf(e.code),1),F(),0==D.length&&k.socket.emit("accelerate",!1))}}function U(e){if("2"==T.value){var t=e.x-k.c.width/2,n=e.y-k.c.height/2,a=Math.atan(n/t)*(180/Math.PI);t<0&&(a+=180),k.socket.emit("setangle",Math.round(a)+360)}}function z(e){"2"==T.value&&k.socket.emit("accelerate",!0)}function H(e){"2"==T.value&&k.socket.emit("accelerate",!1)}function G(e){k.c.width=document.documentElement.clientWidth,k.c.height=document.documentElement.clientHeight}var Y=function(){function e(){Object(d.a)(this,e)}return Object(m.a)(e,null,[{key:"register",value:function(){window.addEventListener("keydown",J),window.addEventListener("keyup",Z),window.addEventListener("mousemove",U),window.addEventListener("mousedown",z),window.addEventListener("mouseup",H),window.addEventListener("resize",G),T=document.getElementById("controlMethod"),G()}},{key:"unregister",value:function(){window.removeEventListener("keydown",J),window.removeEventListener("keyup",Z),window.removeEventListener("resize",G),window.removeEventListener("mousemove",U),window.removeEventListener("mousedown",z),window.removeEventListener("mouseup",H)}}]),e}();var X=function(e){null!=k.socket&&(Y.unregister(),k.socket.removeAllListeners(),k.socket.close(),k.socket=null,clearInterval(k.intervals.colliding),clearInterval(k.intervals.draw),c.a.render(r.a.createElement(Je,null),k.root),null!=e&&alert(e))},Q=n(131),V=(n(342),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={background:"#000000"},e.handleClick=function(){e.setState({displayColorPicker:!e.state.displayColorPicker})},e.handleChangeComplete=function(e){k.socket.emit("changeColor",e.hex)},e.colors=["#d48f22","#bd0808","#e91e63","#ff6bdc","#71157d","#1f138a","#49d1de","#38d674","#0dbd22","#fff45e","#9c9c9c","#363636","#7be3a8","#877be3","#6b6547"],e}return Object(m.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{onClick:this.handleClick},"Toggle ship color picker"),this.state.displayColorPicker?r.a.createElement(Q.SketchPicker,{width:"130px",disableAlpha:!0,presetColors:this.colors,onChangeComplete:this.handleChangeComplete}):null)}}]),n}(r.a.Component)),K=["info","throttle","throttleDisplay","map","mapDisplayChecks","chat","pauseButton"],q=!1;var _=function(){q=!q;var e,t=Object(u.a)(K);try{for(t.s();!(e=t.n()).done;){var n=e.value;document.getElementById(n).style.display=q?"none":null}}catch(a){t.e(a)}finally{t.f()}};function $(){document.getElementById("pauseMenu").style.display="block",document.getElementById("pauseButton").style.visibility="hidden"}function ee(){document.getElementById("pauseMenu").style.display="none",document.getElementById("pauseButton").style.visibility=null}function te(){ee(),X(),setTimeout((function(){return Ce(k.server)}),1)}function ne(){var e=Number(document.getElementById("controlMethod").value),t=document.getElementById("joystickControls");t.style.display=3==e?"":"none"}var ae=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("button",{id:"pauseButton",onClick:$,style:{display:"block"}}),r.a.createElement("div",{id:"pauseMenu",style:{display:"none"}},r.a.createElement("center",{id:"pauseMenuContents"},r.a.createElement("button",{onClick:ee},"Resume"),r.a.createElement("br",null),r.a.createElement(V,null),r.a.createElement("button",{onClick:_},"Toggle UI"),r.a.createElement("br",null),r.a.createElement("button",{onClick:te},"New ship"),r.a.createElement("br",null),r.a.createElement("button",{onClick:function(){return X()}},"Disconnect"),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"controlMethod",style:{color:"white"}},"Control method: "),r.a.createElement("select",{id:"controlMethod",onChange:ne},r.a.createElement("option",{value:0},"steer"),r.a.createElement("option",{value:1},"d-pad"),r.a.createElement("option",{value:2},"mouse"),r.a.createElement("option",{value:3},"joystick")),r.a.createElement("hr",null),r.a.createElement("p",null,"Server: ",k.server.url,r.a.createElement("br",null),"Ping: ",r.a.createElement("span",{id:"ping"},"(pinging...)"),"ms",r.a.createElement("br",null),"FPS: ",r.a.createElement("span",{id:"FPSDisplay"},"(waiting for frame...)")))))}},{key:"componentDidMount",value:function(){document.getElementById("controlMethod").value=1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(document.getElementById("controlMethod").value=3),ne()}}]),n}(r.a.Component),re=n(49),le=n(132),ce=n.n(le);n(347);var oe,ie,se,ue,de,me,he=function(){var e,t=Object(a.useState)(),n=Object(j.a)(t,2),l=n[0],c=n[1],o=Object(a.useState)([]),i=Object(j.a)(o,2),s=(i[0],i[1]);return Object(a.useEffect)((function(){var e=setTimeout((function(){c(k.fuel.current/k.fuel.max),s([])}),1e3);return function(){clearTimeout(e)}})),r.a.createElement(ce.a,(e={id:"fuelGauge",style:{width:250},nrOfLevels:35,percent:0,colors:["#ffffff","#3849ff"]},Object(re.a)(e,"percent",l),Object(re.a)(e,"animDelay",0),Object(re.a)(e,"formatTextValue",(function(e){return"".concat(e.toFixed(1),"%")})),e))},pe=(n(348),!1);function fe(){oe=document.getElementById("map"),ie=oe.getContext("2d"),oe.requestPointerLock=oe.requestPointerLock||oe.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,oe.addEventListener("wheel",ye),oe.addEventListener("mousemove",ve),oe.addEventListener("mousedown",(function(){document.getElementById("mapResetButton").style.display="",pe=!0,oe.requestPointerLock()})),oe.addEventListener("mouseup",(function(){pe=!1,document.exitPointerLock()})),se=oe.width/2,ue=oe.height/2,de=100,me={x:0,y:0},document.getElementById("mapResetButton").style.display="none"}function ye(e){document.getElementById("mapResetButton").style.display="";var t=3;e.deltaY<0&&(t*=-1);var n=1+t/100;de*n>0&&(de*=n,me.x/=n,me.y/=n)}function ve(e){pe&&(me.x+=e.movementX,me.y+=e.movementY)}function Ee(e,t,n){var a=n/2;ie.fillRect(e-a+me.x,t-a+me.y,n,n)}var ge=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{id:"mapContainer"},r.a.createElement("div",null,r.a.createElement("button",{id:"mapResetButton",onClick:fe}),r.a.createElement("br",null),r.a.createElement("canvas",{id:"map",width:150,height:150})),r.a.createElement("div",{id:"mapDisplayChecks",style:{color:"lightgrey",opacity:.28}},r.a.createElement("input",{type:"checkbox",id:"showSelf"}),r.a.createElement("label",{htmlFor:"showSelf"},"Self"),r.a.createElement("br",null),r.a.createElement("input",{type:"checkbox",id:"showPlayers"}),r.a.createElement("label",{htmlFor:"showPlayers"},"Players"),r.a.createElement("br",null),r.a.createElement("input",{type:"checkbox",id:"showStars"}),r.a.createElement("label",{htmlFor:"showStars"},"Stars"),r.a.createElement("br",null),r.a.createElement("input",{type:"checkbox",id:"showPlanets"}),r.a.createElement("label",{htmlFor:"showPlanets"},"Planets")))}},{key:"componentDidMount",value:function(){for(var e=0,t=["showSelf","showPlayers","showStars"];e<t.length;e++){var n=t[e];document.getElementById(n).checked=!0}}}]),n}(r.a.Component),be=n(133),ke=(n(350),n(351),[[0,-2],[-3,-4],[0,4],[3,-4]]),we=new Path2D;for(var Me in ke){var Ie=ke[Me];we[0==Me?"moveTo":"lineTo"](1.6*Ie[0],1.6*Ie[1])}function xe(e){var t="";for(var n in ke){var a=ke[n];t+="".concat(0==n?"M":"L").concat(2*(a[0]+4)," ").concat(2*(a[1]+4)," ")}return t+="Z",r.a.createElement("svg",{className:"player-icon-".concat(e.type),height:16,width:16,transform:"rotate(".concat(e.direction-90,")")},r.a.createElement("path",{d:t,fill:e.color}))}we.closePath();var Be={chat:"#ffffff",action:"#f9ff47"};function Ae(e){return r.a.createElement("div",{className:"chat-message",style:{color:Be[e.message.type]}},e.message.sender?r.a.createElement(xe,{type:"sender",color:e.message.sender.color,direction:e.message.sender.direction}):null,e.message.content?r.a.createElement("span",null,e.message.content):null,e.message.receiver?r.a.createElement(xe,{type:"receiver",color:e.message.receiver.color,direction:e.message.receiver.direction}):null,e.message.append?r.a.createElement("span",null,e.message.append):null)}var Se=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={messages:[]},e}return Object(m.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{id:"chat"},r.a.createElement("button",{id:"openChatButton",onClick:A},r.a.createElement("span",{id:"openChatButtonText"},x.open),"(",r.a.createElement("span",{id:"messagesSentNum"},"0"),")"),r.a.createElement("div",{id:"chatBox"},r.a.createElement("div",{id:"playersOnline"},"Players online: ",r.a.createElement("span",{id:"playerCount"})),r.a.createElement("div",{id:"chatMessages"},this.state.messages),r.a.createElement("div",{id:"sendChat"},r.a.createElement("input",{id:"chatInput",maxLength:100}),r.a.createElement("button",{onClick:S},"Send"))))}}]),n}(r.a.Component);var je=function(){k.socket.on("message",(function(e){var t=document.getElementById("chatMessages");t.innerHTML+=Object(be.renderToString)(r.a.createElement(Ae,{message:e}));var n=document.getElementById("chatMessages").children,a=n[n.length-1],l=t.scrollHeight-t.clientHeight-t.clientTop;l-t.scrollTop<a.clientHeight+5&&(t.scrollTop=l),document.getElementById("messagesSentNum").innerHTML=n.length,B()||(document.getElementById("openChatButton").style.background="#f56262")}))};var Oe=function(){var e=document.getElementById("mainCanvas");k.c=e;var t=e.getContext("2d"),n=0,a=[],r=[],l=Date.now();function c(e,t){return Math.abs(Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)))}function o(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function i(e){e.size=Math.sqrt(e.mass/e.density/Math.PI),e.path.push([e.x,e.y]),t.strokeStyle="#FF0000",t.beginPath(),t.moveTo(e.path[0][0]-s,e.path[0][1]-d);var n,a=Object(u.a)(e.path);try{for(a.s();!(n=a.n()).done;){var l=n.value;t.lineTo(l[0]-s,l[1]-d)}}catch(N){a.e(N)}finally{a.f()}t.stroke(),e.path.length>e.pathMax&&e.path.splice(0,1);var i=10*e.density*50;if(!(e.density>3.5)){if(e.mass>1e3){for(var m=0;m<20;m++){var h=e.color;h=h.replace(")",",0.05)").replace("rgb(","rgba("),t.fillStyle=h,t.strokeStyle=h,t.beginPath(),t.arc(e.x+0-s,e.y+0-d,e.size/2+m*(e.size/1e3)*i,0,2*Math.PI),t.fill(),t.stroke()}var p,f=Object(u.a)(r);try{for(f.s();!(p=f.n()).done;){var y=p.value;if(!(y.mass>1e3)){var v=c(e,y);if(v>e.size/2+y.size/2&&v<e.size/2+e.size/1e3*20*i){t.strokeStyle="#000000",t.fillStyle="#000000";var E=e.size/2+e.size/1e3*20*i-v;E*=2;var g=t.lineWidth,b=y.size;null!=y.shipId&&(b*=8),t.lineWidth=1;var k=o(e,y);t.beginPath();var w={x:Math.cos(k)*e.size/2+e.x,y:Math.sin(k)*e.size/2+e.y},M=k+Math.PI/2,I=Math.cos(M)*(b/2)+y.x,x=Math.sin(M)*(b/2)+y.y,B=o(w,{x:I,y:x});t.moveTo(I-s,x-d),t.lineTo(I+Math.cos(B)*E-s,x+Math.sin(B)*E-d);var A=k+Math.PI/2*3,S=Math.cos(A)*(b/2)+y.x,j=Math.sin(A)*(b/2)+y.y,O=o(w,{x:S,y:j});t.lineTo(S+Math.cos(O)*E-s,j+Math.sin(O)*E-d),t.lineTo(S-s,j-d),t.closePath(),t.fill(),t.stroke(),t.lineWidth=g}}}}catch(N){f.e(N)}finally{f.f()}}if(t.fillStyle=e.color,t.strokeStyle=e.color,null==e.shipId)t.beginPath(),t.arc(e.x+0-s,e.y+0-d,e.size/2,0,2*Math.PI),t.fill(),t.stroke();else{var L=(e.angle-90)*(Math.PI/180);t.translate(e.x+0-s,e.y+0-d),t.rotate(L),t.stroke(we),t.fill(we),t.rotate(-L),t.translate(-(e.x+0-s),-(e.y+0-d))}t.shadowBlur=0,t.fillStyle="#FF0000",t.strokeStyle="#FF0000",t.beginPath(),t.moveTo(e.x-s,e.y-d);if(t.lineTo(20*e.xVel+e.x-s,20*e.yVel+e.y-d),t.stroke(),e.nuke&&(t.fillStyle="#FFFF00",t.strokeStyle="#FFFF00",t.fillText("*",e.x,e.y)),g=t.lineWidth,t.lineWidth=100,e.texture){var T,C=Object(u.a)(e.texture);try{for(C.s();!(T=C.n()).done;){var P=T.value,D={sx:P.sx*Math.cos(e.angle)-P.sy*Math.sin(e.angle),sy:P.sx*Math.sin(e.angle)+P.sy*Math.cos(e.angle),ex:P.ex*Math.cos(e.angle)-P.ey*Math.sin(e.angle),ey:P.ex*Math.sin(e.angle)+P.ey*Math.cos(e.angle)};t.strokeStyle=P.color,t.lineWidth=P.width,t.beginPath(),t.moveTo(D.sx+e.x-s,D.sy+e.y-d),t.lineTo(D.ex+e.x-s,D.ey+e.y-d),t.stroke()}}catch(N){C.e(N)}finally{C.f()}}t.lineWidth=g}}Y.register();var s=0,d=0;k.intervals.draw=setInterval((function(){for(var o in r.length>0&&(s=r[n].x-e.width/2,d=r[n].y-e.height/2),a=[],r)o!=n&&null!=r[o].shipId&&a.push(o);if(t.fillStyle="#000000",t.fillRect(0,0,e.width,e.height),void 0!=r[n]){var m,h=Object(u.a)(r);try{for(h.s();!(m=h.n()).done;){var p=m.value;c(p,r[n])<3*k.c.width&&i(p)}}catch(y){h.e(y)}finally{h.f()}}if(function(e,t){if(ie.clearRect(0,0,oe.width,oe.height),e[t]){var n=e[t];for(var a in e)if(a!=t){var r=e[a];if(!r.shipId||document.getElementById("showPlayers").checked){var l=r.mass>1e3;if((!l||document.getElementById("showStars").checked)&&(r.shipId||l||document.getElementById("showPlanets").checked)){ie.fillStyle=r.color;var c=(r.x-n.x)/de,o=(r.y-n.y)/de;Ee(se+c,ue+o,r.shipId?4:r.size/10*(100/de))}}}document.getElementById("showSelf").checked&&(ie.fillStyle=n.color,Ee(se,ue,5))}}(r,n),null!=r[n]){var f=Date.now();document.getElementById("speedspan").innerHTML=Math.round(100*Math.sqrt(r[n].yVel*r[n].yVel+r[n].xVel*r[n].xVel))/100,document.getElementById("xcoord").innerHTML=Math.round(r[n].x),document.getElementById("ycoord").innerHTML=Math.round(r[n].y),document.getElementById("playerCount").innerHTML=a.length+1,document.getElementById("FPSDisplay").innerHTML=Math.round(1e3/(f-l)),l=f}}),50);var m=0;k.socket.on("connect",(function(){m=k.socket.id})),k.socket.on("pong",(function(e){document.getElementById("ping").innerHTML=e})),k.socket.on("kick",(function(e){setTimeout((function(){X(e)}),500)})),k.socket.on("disconnect",(function(){setTimeout((function(){X("Communication between you and the server was interrupted.")}),750)})),k.socket.on("fuelUpdate",(function(e){k.fuel.current=e})),k.socket.on("fuelUsageUpdate",(function(e){k.fuel.currentUsage=e})),k.socket.on("bodyupdate",(function(e){r=JSON.parse(e);var t=!1;for(var a in r){if(null!=r[a].shipId)r[a].shipId==m&&(n=a,t=!0)}t||(n=0,k.socket.emit("newShip"))})),k.socket.on("center",(function(e){n=e})),je()};var Le=function(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=JSON.parse(e.responseText);k.fuel.max=t.fuelMax}},e.open("GET","http".concat(k.server.secure?"s":"","://").concat(k.server.url,"/detailedinfo"),!0),e.send(null)},Te=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("canvas",{id:"mainCanvas"}),r.a.createElement("div",{id:"info"},"velocity: ",r.a.createElement("span",{id:"speedspan"}),"km/s",r.a.createElement("br",null),"x: ",r.a.createElement("span",{id:"xcoord"})," y: ",r.a.createElement("span",{id:"ycoord"})),r.a.createElement(I,null),r.a.createElement(ae,null),r.a.createElement(he,null),r.a.createElement(C,null),r.a.createElement(ge,null),r.a.createElement(Se,null))}},{key:"componentDidMount",value:function(){fe(),Le(),Oe()}}]),n}(r.a.Component);var Ce=function(e){k.socket=v()("ws".concat(e.secure?"s":"","://").concat(e.url),{transports:["websocket"]}),k.server=e,k.socket.on("reconnect_attempt",(function(){k.socket.io.opts.transports=["polling","websocket"]})),c.a.render(r.a.createElement(Te,null),k.root)},Pe=n(134);function De(e){var t="";return e>86400&&(t+=Math.floor(e/86400)+":"),e>3600&&(t+=Math.floor(e/3600%24).toString().padStart(2,"0")+":"),t+=Math.floor(e/60%60).toString().padStart(2,"0")+":"+(e%60).toString().padStart(2,"0")}function Ne(){for(var e=document.getElementById("toConnect").value;"/"==e[e.length-1];)e=e.slice(0,-1);var t={url:e,secure:!1};e.startsWith("http://")?t.url=e.slice("http://".length):e.startsWith("https://")&&(t.url=e.slice("https://".length),t.secure=!0),Ce(t)}function Re(){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(f.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.render(r.a.createElement("div",null),k.root);case 2:c.a.render(r.a.createElement(We,null),k.root);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var We=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var a;return Object(d.a)(this,n),(a=t.call(this,e)).state={servers:[]},a}return Object(m.a)(n,[{key:"render",value:function(){return null!=k.socket&&(k.socket.close(),k.socket=null),r.a.createElement("div",null,r.a.createElement("h1",null,"space-sim",r.a.createElement("br",null),r.a.createElement("a",{href:"https://github.com/xXDerpyXx/space-sim"},r.a.createElement("img",{className:"social-icon",src:"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png"})),r.a.createElement("a",{href:"https://discord.gg/mU4xTzK"},r.a.createElement("img",{className:"social-icon",src:"https://discord.com/assets/41484d92c876f76b20c7f746221e8151.svg",height:"32"}))),r.a.createElement("label",null,"Direct connect:"),r.a.createElement("br",null),r.a.createElement("input",{id:"toConnect",placeholder:"Address",onKeyUp:function(e){"Enter"===e.key&&Ne()}}),r.a.createElement("button",{onClick:Ne},"Connect"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("label",null,"Official serverlist",r.a.createElement("button",{onClick:Re,style:{fontSize:"18px"}},"\u27f3"),":"),r.a.createElement("table",{id:"serverList"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Address"),r.a.createElement("th",null,"Players"),r.a.createElement("th",null,"Time left"),r.a.createElement("th",null,"Location"))),r.a.createElement("tbody",null,this.state.servers)),r.a.createElement("br",null))}},{key:"componentDidMount",value:function(){var e,t=this,n="https:"==window.location.protocol,a=Object(u.a)(Pe);try{var l=function(){var a=e.value;if(n&&!a.secure)return"continue";var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==l.readyState&&200==l.status){var e=JSON.parse(l.responseText);t.setState((function(t){return{servers:[].concat(Object(s.a)(t.servers),[r.a.createElement("tr",{key:t.servers.length,onClick:function(){return Ce(a)}},r.a.createElement("td",null,e.name),r.a.createElement("td",null,a.url),r.a.createElement("td",{className:"centered"},e.players),r.a.createElement("td",{className:"centered"},e.timeLeft?De(Math.round(e.timeLeft/1e3)):null),r.a.createElement("td",{className:"centered"},e.location))])}}))}},l.open("GET","http".concat(a.secure?"s":"","://").concat(a.url,"/basicinfo"),!0),l.send(null)};for(a.s();!(e=a.n()).done;)l()}catch(c){a.e(c)}finally{a.f()}}}]),n}(r.a.Component),Je=We;c.a.render(r.a.createElement(Je,null),k.root)}},[[138,1,2]]]);
//# sourceMappingURL=main.2c81757a.chunk.js.map